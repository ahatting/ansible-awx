---
- name: Add or remove a registry key
  hosts: '{{ resourcename }}'
  gather_facts: False
  vars:
    ansible_user: '{{ accountname }}'
    ansible_password: "{{ lookup('passwordmanagerpro','{{ inventory_hostname }}', '{{ accountname }}') }}"

  tasks:
      - block:
          - name: Adds or removes the key
            win_regedit:
              path: '{{ reg_keypath }}'
              name: '{{ reg_keyname }}'
              data: '{{ reg_keydata }}'
              type: '{{ reg_keytype }}'
              state: '{{reg_keystate }}'
